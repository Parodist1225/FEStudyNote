# ECMAScript 6.0(é˜®ä¸€å³°) å­¦ä¹ ç¬”è®°
(å¼•ç”¨éƒ¨åˆ†å¤šä¸ºCVï¼Œæˆ–æœ‰åˆ æ”¹)

[toc]
## No1.ECMAScript6ç®€ä»‹ 
##### 1.ECMAScript6å’Œ JavaScript çš„å…³ç³»
> ECMAæ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–ç»„ç»‡,ä¸ºJavascriptè§„å®šäº†ä½¿ç”¨æ ‡å‡†ï¼Œå¹¶å°†å…¶ç§°ä½œæ˜¯ ECMAScriptã€‚ECMAScriptæ˜¯JavaScriptçš„è§„æ ¼ï¼Œåè€…æ˜¯å‰è€…çš„ä¸€ç§å®ç°ã€‚

##### 2.ES6 ä¸ ECMAScript 2015 çš„å…³ç³»
>ES6 æ—¢æ˜¯ä¸€ä¸ªå†å²åè¯ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ³›æŒ‡ï¼Œå«ä¹‰æ˜¯ 5.1 ç‰ˆä»¥åçš„ JavaScript çš„ä¸‹ä¸€ä»£æ ‡å‡†

##### 3.ECMAScript çš„å†å²
>åˆå­¦è€…ä¸€å¼€å§‹å­¦ä¹  JavaScriptï¼Œå…¶å®å°±æ˜¯åœ¨å­¦ 3.0 ç‰ˆçš„è¯­æ³•ã€‚

åˆå­¦è€…->æŒ‡æˆ‘()
>**Node.js** æ˜¯ JavaScript çš„æœåŠ¡å™¨è¿è¡Œç¯å¢ƒï¼ˆruntimeï¼‰ã€‚å®ƒå¯¹ ES6 çš„æ”¯æŒåº¦æ›´é«˜ã€‚é™¤äº†é‚£äº›é»˜è®¤æ‰“å¼€çš„åŠŸèƒ½ï¼Œè¿˜æœ‰ä¸€äº›è¯­æ³•åŠŸèƒ½å·²ç»å®ç°äº†ï¼Œä½†æ˜¯é»˜è®¤æ²¡æœ‰æ‰“å¼€ã€‚ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹ Node.js é»˜è®¤æ²¡æœ‰æ‰“å¼€çš„ ES6 å®éªŒæ€§è¯­æ³•ã€‚

>// Linux & Mac
        $ node --v8-options | grep harmony

>// Windows
        $ node --v8-options | findstr harmony

ps:æˆ‘è¯•ç€åœ¨æˆ‘çš„win11é‡Œä»¥ç®¡ç†å‘˜æƒé™æ‰“å¼€äº†Powershellé‡Œè¿è¡Œäº†ä¸‹ï¼ŒæŠ¥é”™â€œæ‰¾ä¸åˆ°å‘½ä»¤ findstrï¼Œä½†å®ƒç¡®å®å­˜åœ¨äºå½“å‰ä½ç½®ã€‚â€,æ”¹ä¸ºè¾“å…¥node --v8-options | .\findstr harmony
æˆåŠŸæŸ¥çœ‹--harmony (enable all completed harmony features)
<br>
##### 4.Babel è½¬ç å™¨//ç•¥

>Babel æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ ES6 è½¬ç å™¨ï¼Œå¯ä»¥å°† ES6 ä»£ç è½¬ä¸º ES5 ä»£ç ï¼Œä»è€Œåœ¨è€ç‰ˆæœ¬çš„æµè§ˆå™¨æ‰§è¡Œã€‚
****
## No2.let å’Œ const å‘½ä»¤
#### â‘ let
##### I.letä¸varç›¸æ¯”
 **let**å£°æ˜çš„å˜é‡åªåœ¨å®ƒæ‰€åœ¨çš„**å—çº§ä½œç”¨åŸŸ**æœ‰æ•ˆ
 è€Œvarå…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆ
PS:(å› æ­¤,forå¾ªç¯çš„è®¡æ•°å™¨ï¼Œå°±å¾ˆåˆé€‚ä½¿ç”¨letå‘½ä»¤)
ä¸€ä¸ªæœ‰æ„æ€çš„ä¾‹å­:
```js
>var a = [];
for (let i = 0; i < 10; i++) {
  a[i] = function () {
    console.log(i);
  };
}
a\[6](); // 6
//æ¯ä¸€è½®å¾ªç¯çš„å˜é‡iéƒ½æ˜¯é‡æ–°å£°æ˜çš„!
```
JavaScript å¼•æ“å†…éƒ¨ä¼šè®°ä½ä¸Šä¸€è½®å¾ªç¯çš„å€¼ï¼Œåˆå§‹åŒ–æœ¬è½®çš„å˜é‡iæ—¶ï¼Œå°±åœ¨ä¸Šä¸€è½®å¾ªç¯çš„åŸºç¡€ä¸Šè¿›è¡Œè®¡ç®—ï¼
æ¢æˆvarå°±æ˜¯10ï¼
**å…³äºforå¾ªç¯**
forå¾ªç¯è¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«ä¹‹å¤„ï¼Œè®¾ç½®å¾ªç¯å˜é‡çš„é‚£éƒ¨åˆ†æ˜¯ä¸€ä¸ªçˆ¶ä½œç”¨åŸŸï¼Œè€Œå¾ªç¯ä½“å†…éƒ¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­ä½œç”¨åŸŸï¼
```js
>for (let i = 0; i < 3; i++) {
  let i = 'abc';
  console.log(i);
}
// abc
// abc
// abc
```
##### II.letä¸å­˜åœ¨å˜é‡æå‡
å˜é‡æå‡ï¼šå˜é‡å¯ä»¥åœ¨å£°æ˜ä¹‹å‰ä½¿ç”¨ï¼Œä½†å€¼ä¸ºundefined
```js
>// var çš„æƒ…å†µ
console.log(foo); // è¾“å‡ºundefined
var foo = 2;
// let çš„æƒ…å†µ
console.log(bar); // æŠ¥é”™ReferenceError
let bar = 2;
```
##### III.æš‚æ—¶æ€§æ­»åŒº:TDZ
åªè¦å—çº§ä½œç”¨åŸŸå†…å­˜åœ¨letå‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°±â€œç»‘å®šâ€ï¼ˆbindingï¼‰è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨çš„å½±å“
```js
>var tmp = 123;
if (true) {
  tmp = 'abc'; // ReferenceError
  //æ­¤è¡Œä»¥ä¸Šå³ä¸ºtmpçš„æ­»åŒº
  let tmp;//ä¸èƒ½å˜é‡æå‡
}
```
è¿›ä¸€æ­¥æ€è€ƒï¼š
```js
>// æŠ¥é”™
let x = x;
// ReferenceError: x is not defined
åªè¦å˜é‡åœ¨è¿˜**æ²¡æœ‰å£°æ˜å®Œæˆå‰**ä½¿ç”¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚
```
##### IV.ä¸å…è®¸é‡å¤å£°æ˜
letä¸å…è®¸åœ¨ç›¸åŒä½œç”¨åŸŸå†…ï¼Œé‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡ã€‚
#### â‘¡å—çº§ä½œç”¨åŸŸ       å³{}å†…
##### I.ES6 å—çº§ä½œç”¨åŸŸ
**å…è®¸å—çº§ä½œç”¨åŸŸçš„ä»»æ„åµŒå¥—,**
**æ¯ä¸€å±‚éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸ,**
**æ— æ³•è¯»å–ä¸åŒå±‚çš„å†…éƒ¨å˜é‡ã€‚**
å†…å±‚ä½œç”¨åŸŸå¯ä»¥å®šä¹‰å¤–å±‚ä½œç”¨åŸŸçš„**åŒå**å˜é‡ï¼š
```js
>{{{{
  let insane = 'Hello World';
  {let insane = 'Hello World'}
}}}};
```
##### II.å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜
ES6æ˜ç¡®å…è®¸åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ã€‚
å—çº§ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå‡½æ•°å£°æ˜è¯­å¥çš„è¡Œä¸ºç±»ä¼¼äºletï¼Œåœ¨å—çº§ä½œç”¨åŸŸä¹‹å¤–ä¸å¯å¼•ç”¨ã€‚
!!<strong>æµè§ˆå™¨çš„å®ç°å¯ä»¥ä¸éµå®ˆä¸Šé¢çš„è§„å®šï¼Œæœ‰è‡ªå·±çš„è¡Œä¸ºæ–¹å¼ã€‚
<ul><li>å…è®¸åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚
<li>å‡½æ•°å£°æ˜ç±»ä¼¼äºvarï¼Œå³ä¼šæå‡åˆ°å…¨å±€ä½œç”¨åŸŸæˆ–å‡½æ•°ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚
<li>å‡½æ•°å£°æ˜è¿˜ä¼šæå‡åˆ°æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚
</ul>ä¸Šé¢ä¸‰æ¡è§„åˆ™åªå¯¹ ES6 çš„æµè§ˆå™¨å®ç°æœ‰æ•ˆ
</strong>

*ç”±ä»¥ä¸Šï¼Œåº”è¯¥é¿å…åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚å¦‚æœç¡®å®éœ€è¦ï¼Œä¹Ÿåº”è¯¥å†™æˆå‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯å‡½æ•°å£°æ˜è¯­å¥ã€‚*
```js
// å—çº§ä½œç”¨åŸŸå†…éƒ¨çš„å‡½æ•°å£°æ˜è¯­å¥ï¼Œå»ºè®®ä¸è¦ä½¿ç”¨
{
  let a = 'secret';
  function f() {
    return a;
  }
}
// å—çº§ä½œç”¨åŸŸå†…éƒ¨ï¼Œä¼˜å…ˆä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼
{
  let a = 'secret';
  let f = function () {
    return a;
  };
}
```
#### â‘¢const
##### I.constå£°æ˜ä¸€ä¸ªåªè¯»çš„å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜
PS:constä¸€æ—¦å£°æ˜å˜é‡ï¼Œå°±å¿…é¡»**ç«‹å³**åˆå§‹åŒ–,å¦‚
>const a;æŠ¥é”™

constçš„ä½œç”¨åŸŸä¸letå‘½ä»¤ç›¸åŒï¼š
1.åªåœ¨å£°æ˜æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼›
2.å£°æ˜çš„å¸¸é‡ä¹Ÿæ˜¯ä¸æå‡ï¼Œ
3.åŒæ ·å­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼Œåªèƒ½åœ¨å£°æ˜çš„ä½ç½®åé¢ä½¿ç”¨ã€‚
##### II.constæœ¬è´¨ç†è§£ï¼š
å®é™…ä¸Šï¼Œä¸æ˜¯è¯´å˜é‡ä¸èƒ½æ”¹å˜ï¼Œè€Œæ˜¯**å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€æ‰€ä¿å­˜çš„æ•°æ®ä¸å¾—æ”¹åŠ¨**

>æ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼Œå€¼å°±ä¿å­˜åœ¨å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤ç­‰åŒäºå¸¸é‡ã€‚

>å¯¹è±¡,æ•°ç»„ï¼Œå˜é‡æŒ‡å‘çš„å†…å­˜åœ°å€ï¼Œä¿å­˜çš„åªæ˜¯ä¸€ä¸ªæŒ‡å‘å®é™…æ•°æ®çš„æŒ‡é’ˆï¼Œconståªèƒ½ä¿è¯è¿™ä¸ªæŒ‡é’ˆæ˜¯å›ºå®šçš„ï¼ˆå³æ€»æ˜¯æŒ‡å‘ä¸€ä¸ªå›ºå®šçš„åœ°å€ï¼‰
```js
const foo = {};
// ä¸º foo æ·»åŠ ä¸€ä¸ªå±æ€§ï¼Œå¯ä»¥æˆåŠŸ
foo.prop = 123;
foo.prop // 123
// å°† foo æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šæŠ¥é”™
foo = {}; // TypeError: "foo" is read-only
```
**PS:å‚è€ƒc++é‡ŒæŒ‡é’ˆæ¦‚å¿µä¸pythonä¸­å…ƒç»„é‡Œæ”¾åˆ—è¡¨ï¼Œåˆ—è¡¨å¯ä»¥changeå…ƒç´ çš„æƒ…å½¢**
###### å†»ç»“ä¸€ä¸ªå¯¹è±¡
```js
>const foo = Object.freeze({});
// å¸¸è§„æ¨¡å¼æ—¶ï¼Œä¸‹é¢ä¸€è¡Œä¸èµ·ä½œç”¨ï¼›
// ä¸¥æ ¼æ¨¡å¼æ—¶ï¼Œè¯¥è¡Œä¼šæŠ¥é”™
foo.prop = 123;
```
###### ES6 å£°æ˜å˜é‡çš„å…­ç§æ–¹æ³•
var   function  let const  import  class

#### â‘£é¡¶å±‚å¯¹è±¡çš„å±æ€§
**é¡¶å±‚å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒæŒ‡çš„æ˜¯windowå¯¹è±¡ï¼Œåœ¨ Node æŒ‡çš„æ˜¯globalå¯¹è±¡ã€‚**
windowå¯¹è±¡æœ‰å®ä½“å«ä¹‰ï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨çš„çª—å£å¯¹è±¡
*ES6è§„å®šï¼Œ*
varå‘½ä»¤å’Œfunctionå‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¾æ—§æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼›
letå‘½ä»¤ã€constå‘½ä»¤ã€classå‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¸å±äºé¡¶å±‚å¯¹è±¡çš„å±æ€§
**SO:**
```js
>var a = 1;
// å¦‚æœåœ¨ Node çš„ REPL ç¯å¢ƒï¼Œå¯ä»¥å†™æˆ global.a
// æˆ–è€…é‡‡ç”¨é€šç”¨æ–¹æ³•ï¼Œå†™æˆ this.a
window.a // 1
let b = 1;
window.b // undefined
```
#### â‘¤globalThis å¯¹è±¡
**I.æµè§ˆå™¨é¡¶å±‚å¯¹è±¡æ˜¯windowï¼ˆ Node å’Œ Web Worker æ²¡æœ‰windowã€‚ï¼‰**
**II.æµè§ˆå™¨å’Œ Web Worker é‡Œé¢selfä¹ŸæŒ‡å‘é¡¶å±‚å¯¹è±¡ï¼ˆ Node æ²¡æœ‰selfã€‚ï¼‰**
**III.Node é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯globalï¼ˆä½†å…¶ä»–ç¯å¢ƒéƒ½ä¸æ”¯æŒã€‚ï¼‰**
>åŒä¸€æ®µä»£ç ä¸ºäº†èƒ½å¤Ÿåœ¨å„ç§ç¯å¢ƒï¼Œéƒ½èƒ½å–åˆ°é¡¶å±‚å¯¹è±¡ï¼Œç°åœ¨ä¸€èˆ¬æ˜¯ä½¿ç”¨thiså˜é‡ï¼Œä½†æ˜¯æœ‰å±€é™æ€§ï¼š
1.å…¨å±€ç¯å¢ƒä¸­ï¼Œthisä¼šè¿”å›é¡¶å±‚å¯¹è±¡ã€‚**ï¼Node æ¨¡å—å’Œ ES6 æ¨¡å—ä¸­ï¼Œthisè¿”å›çš„æ˜¯å½“å‰æ¨¡å—ã€‚**
2.å‡½æ•°é‡Œé¢çš„thisï¼Œå¦‚æœå‡½æ•°ä¸æ˜¯ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¿è¡Œï¼Œè€Œæ˜¯å•çº¯ä½œä¸ºå‡½æ•°è¿è¡Œï¼Œ**thisä¼šæŒ‡å‘é¡¶å±‚å¯¹è±¡**ã€‚
>ï¼ˆä½†æ˜¯ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™æ—¶thisä¼šè¿”å›undefinedã€‚ï¼‰
3.ä¸ç®¡æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œè¿˜æ˜¯æ™®é€šæ¨¡å¼ï¼Œ**new Function('return this')()ï¼Œæ€»æ˜¯ä¼šè¿”å›å…¨å±€å¯¹è±¡ã€‚**
ï¼Ÿï¼Ÿï¼Ÿå¦‚æœæµè§ˆå™¨ç”¨äº† CSPï¼ˆContent Security Policyï¼Œå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰ï¼Œé‚£ä¹ˆevalã€new Functionè¿™äº›æ–¹æ³•éƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ã€‚
>>å–åˆ°é¡¶å±‚å¯¹è±¡ä¸¤ä¸ªæ–¹æ³•
```js
// æ–¹æ³•ä¸€
(typeof window !== 'undefined'
   ? window
   : (typeof process === 'object' &&
      typeof require === 'function' &&
      typeof global === 'object')
     ? global
     : this);
     PS:æ­¤åˆ»æˆ‘è§‰å¾—æ–¹æ³•äºŒè¿œæ›´æ˜“äºæ¥å—ï¼Œä¸€çš„"?",":"æ˜¯å•¥å•Š...
// æ–¹æ³•äºŒ
var getGlobal = function () {
  if (typeof self !== 'undefined') { return self; }
  if (typeof window !== 'undefined') { return window; }
  if (typeof global !== 'undefined') { return global; }
  throw new Error('unable to locate global object');
};
```
**ES2020 å¼•å…¥globalThisä½œä¸ºé¡¶å±‚å¯¹è±¡ã€‚
ä»»ä½•ç¯å¢ƒä¸‹ï¼ŒglobalThiséƒ½æ˜¯å­˜åœ¨çš„ï¼Œéƒ½å¯ä»¥ä»å®ƒæ‹¿åˆ°é¡¶å±‚å¯¹è±¡ï¼ŒæŒ‡å‘å…¨å±€ç¯å¢ƒä¸‹çš„this!**

## No3.å˜é‡çš„è§£æ„èµ‹å€¼
### I.æ•°ç»„çš„è§£æ„èµ‹å€¼
ES6 å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«
ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚
1. å¯ä»¥ä»æ•°ç»„ä¸­æå–å€¼ï¼Œ**æŒ‰ç…§å¯¹åº”ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼**
```js
let [foo, [[bar], baz]] = [1, [[2], 3]];
foo // 1
bar // 2
baz // 3

let [x, , y] = [1, 2, 3];
x // 1
y // 3

let [head, ...tail] = [1, 2, 3, 4];
head // 1
tail // [2, 3, 4]

let [x, y, ...z] = ['a'];
x // "a"
y // undefined
z // []
```
2. å¦‚æœè§£æ„ä¸æˆåŠŸï¼Œå˜é‡çš„å€¼å°±ç­‰äºundefinedã€‚
```js
let [foo] = [];
let [bar, foo] = [1];//fooå‡ä¸ºundefined
```
3. ä¸å®Œå…¨è§£æ„ï¼Œå³ç­‰å·å·¦è¾¹çš„æ¨¡å¼ï¼ŒåªåŒ¹é…ä¸€éƒ¨åˆ†çš„ç­‰å·å³è¾¹çš„æ•°ç»„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè§£æ„ä¾ç„¶å¯ä»¥æˆåŠŸ
```js
let [x, y] = [1, 2, 3];
x // 1
y // 2
let [a, [b], d] = [1, [2, 3], 4];
a // 1
b // 2
d // 4
```
4. =å³è¾¹åº”æ˜¯å¯éå†çš„ç»“æ„ï¼Œå…·å¤‡ Iterator æ¥å£
5. é»˜è®¤å€¼
è§£æ„èµ‹å€¼å…è®¸æŒ‡å®šé»˜è®¤å€¼
```js
let [x, y = 'b'] = ['a']; // x='a', y='b'
```
>ES6 å†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰ï¼Œåˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯å¦æœ‰å€¼ã€‚æ‰€ä»¥ï¼Œåªæœ‰å½“ä¸€ä¸ªæ•°ç»„æˆå‘˜ä¸¥æ ¼ç­‰äºundefinedï¼Œé»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆ
```js
let [x = 1] = [undefined];
x // 1
let [x = 1] = [null];
x // null
//nullä¸ä¸¥æ ¼ç­‰äºundefined
```
è‹¥é»˜è®¤å€¼æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼æ˜¯æƒ°æ€§æ±‚å€¼çš„ï¼Œå³åªæœ‰åœ¨ç”¨åˆ°çš„æ—¶å€™ï¼Œæ‰ä¼šæ±‚å€¼ã€‚
```js
let [x = 1, y = x] = [];     // x=1; y=1
let [x = 1, y = x] = [2];    // x=2; y=2!!
let [x = 1, y = x] = [1, 2]; // x=1; y=2
let [x = y, y = 1] = [];     // ReferenceError: y is not defined
```
### II.å¯¹è±¡çš„è§£æ„èµ‹å€¼
#### â‘ ç®€ä»‹
1. æ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åˆ—çš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®šï¼›è€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼
```js
let { bar, foo } = { foo: 'aaa', bar: 'bbb' };
foo // "aaa"
bar // "bbb"
```
2. å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†ç°æœ‰å¯¹è±¡çš„æ–¹æ³•ï¼Œèµ‹å€¼åˆ°æŸä¸ªå˜é‡ã€‚
```js
// ä¾‹ä¸€
let { log, sin, cos } = Math;
// ä¾‹äºŒ
const { log } = console;
log('hello') // hello
```
3. å®è´¨,å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹ç»™å¯¹åº”çš„å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯å˜é‡bazï¼Œè€Œä¸æ˜¯æ¨¡å¼fooã€‚
```js
let { foo: baz } = { foo: 'aaa', bar: 'bbb' };
baz // "aaa"
foo // error: foo is not defined
```
4. è§£æ„ç”¨äºåµŒå¥—ç»“æ„çš„å¯¹è±¡(ä¸‹ä¾‹åŒæ—¶ç»™æ¨¡å¼èµ‹å€¼):
```js
let obj = {
  p: [
    'Hello',
    { y: 'World' }
  ]
};
let { p, p: [x, { y }] } = obj;
x // "Hello"
y // "World"
p // ["Hello", {y: "World"}]
```
å¤æ‚ä¸€ç‚¹çš„åµŒå¥—
```js
const node = {
  loc: {
    start: {
      line: 1,
      column: 5
    }
  }
};
let { loc, loc: { start }, loc: { start: { line }} } = node;
line // 1
loc  // Object {start: Object}
start // Object {line: 1, column: 5}
```
5. å¯¹è±¡çš„è§£æ„èµ‹å€¼å¯ä»¥å–åˆ°ç»§æ‰¿çš„å±æ€§
```js
const obj1 = {};
const obj2 = { foo: 'bar' };
Object.setPrototypeOf(obj1, obj2);
const { foo } = obj1;
foo // "bar"
```
#### â‘¡é»˜è®¤å€¼
é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯:å¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äºundefined
```js
var {x, y = 5} = {x: 1};
x // 1
y // 5
var {x: y = 3} = {};
y // 3
var {x: y = 3} = {x: 5};
y // 5
```
#### â‘¢æ³¨æ„ç‚¹
ï¼ˆ1ï¼‰å°†ä¸€ä¸ªå·²ç»å£°æ˜çš„å˜é‡ç”¨äºè§£æ„èµ‹å€¼ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚
```js
// é”™è¯¯çš„å†™æ³•
let x;
{x} = {x: 1};
// SyntaxError: syntax error
//ä¸Šé¢ä»£ç çš„å†™æ³•ä¼šæŠ¥é”™ï¼Œ
å› ä¸º JavaScript å¼•æ“ä¼šå°†{x}ç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œ
//ä»è€Œå‘ç”Ÿè¯­æ³•é”™è¯¯ã€‚
//åªæœ‰ä¸å°†å¤§æ‹¬å·å†™åœ¨è¡Œé¦–ï¼Œé¿å… JavaScript å°†å…¶è§£é‡Šä¸ºä»£ç å—
// æ­£ç¡®çš„å†™æ³•
let x;
({x} = {x: 1});
```
 ï¼ˆ2ï¼‰æ•°ç»„æœ¬è´¨æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œå¯¹è±¡å±æ€§çš„è§£æ„
```js
let arr = [1, 2, 3];
let {0 : first, [arr.length - 1] : last} = arr;
first // 1
last // 3
```
(PSï¼š0é”®å¯¹åº”1ï¼Œ[arr.length - 1]å³2é”®å¯¹åº”å–åˆ°3)
### III.å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼
å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥è§£æ„èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸ºæ­¤æ—¶ï¼Œå­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚
```JS
const [a, b, c, d, e] = 'hello';
a // "h"
b // "e"
c // "l"
d // "l"
e // "o"
```
ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªlengthå±æ€§
```JS
let {length : len} = 'hello';
len // 5
```
### IV.æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼
è§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œå°±å…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äºundefinedå’Œnullæ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚
```JS
let {toString: s} = 123;
s === Number.prototype.toString // true
let {toString: s} = true;
s === Boolean.prototype.toString // true
```
(ps:æ•°å€¼å’Œå¸ƒå°”å€¼çš„åŒ…è£…å¯¹è±¡éƒ½æœ‰toStringå±æ€§ï¼Œå› æ­¤å˜é‡séƒ½èƒ½å–åˆ°å€¼ã€‚)
### V.å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼
eg1:
```js
function add([x, y]){
  return x + y;
}
add([1, 2]); // 3
```
eg2(mapå‡½æ•°åº”ç”¨):
```js
[[1, 2], [3, 4]].map(([a, b]) => a + b);
// [ 3, 7 ]
```
ä½¿ç”¨é»˜è®¤å€¼:
```js
function move({x = 0, y = 0} = {}) {
  return [x, y];
}
move({x: 3, y: 8}); // [3, 8]
move({x: 3}); // [3, 0]
move({}); // [0, 0]
move(); // [0, 0]
```
undefinedå°±ä¼šè§¦å‘å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚
```js
[1, undefined, 3].map((x = 'yes') => x);
// [ 1, 'yes', 3 ]
```
### VI.åœ†æ‹¬å·é—®é¢˜
å»ºè®®åªè¦æœ‰å¯èƒ½ï¼Œå°±ä¸è¦åœ¨æ¨¡å¼ä¸­æ”¾ç½®åœ†æ‹¬å·
å°¤å…¶
* å˜é‡å£°æ˜è¯­å¥
```js
let [(a)] = [1];
```
* å‡½æ•°å‚æ•°
```js
function f([z,(x)]) { return x; }
```
* èµ‹å€¼è¯­å¥çš„æ¨¡å¼
```js
// å…¨éƒ¨æŠ¥é”™
({ p: a }) = { p: 42 };
([a]) = [5];
```
>å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µåªæœ‰ä¸€ç§ï¼š**èµ‹å€¼**è¯­å¥çš„**éæ¨¡å¼éƒ¨åˆ†**ï¼Œå¯ä»¥ä½¿ç”¨åœ†æ‹¬å·ã€‚
```js
[(b)] = [3]; // æ­£ç¡®
//æ¨¡å¼æ˜¯å–æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œè·Ÿåœ†æ‹¬å·æ— å…³

({ p: (d) } = {}); // æ­£ç¡®
//æ¨¡å¼æ˜¯pï¼Œè€Œä¸æ˜¯d

[(parseInt.prop)] = [3]; // æ­£ç¡®
```
### VII.å˜é‡çš„è§£æ„èµ‹å€¼ç”¨é€”
#### â‘ äº¤æ¢å˜é‡çš„å€¼(ç®€æ´)
```js
let x = 1;
let y = 2;
[x, y] = [y, x];
```
#### â‘¡ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼
```js
// è¿”å›ä¸€ä¸ªæ•°ç»„
function example() {
  return [1, 2, 3];
}
let [a, b, c] = example();
// è¿”å›ä¸€ä¸ªå¯¹è±¡
function example() {
  return {
    foo: 1,
    bar: 2
  };
}
let { foo, bar } = example();
```
#### â‘¢å‡½æ•°å‚æ•°çš„å®šä¹‰
```js
// å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼
function f([x, y, z]) { ... }
f([1, 2, 3]);
// å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼
function f({x, y, z}) { ... }
f({z: 3, y: 2, x: 1});
```
#### â‘£æå– JSON æ•°æ® !!
```js
let jsonData = {
  id: 42,
  status: "OK",
  data: [867, 5309]
};
let { id, status, data: number } = jsonData;
console.log(id, status, number);
// 42, "OK", [867, 5309]
```
#### â‘¤å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼
```js
jQuery.ajax = function (url, {
  async = true,
  beforeSend = function () {},
  cache = true,
  complete = function () {},
  crossDomain = false,
  global = true,
  // ... more config
} = {}) {
  // ... do stuff
};
```
æŒ‡å®šå‚æ•°çš„é»˜è®¤å€¼ï¼Œå°±é¿å…äº†åœ¨å‡½æ•°ä½“å†…éƒ¨å†å†™`var foo = config.foo || 'default foo';`è¿™æ ·çš„è¯­å¥
#### â‘¥éå† Map ç»“æ„
Map ç»“æ„åŸç”Ÿæ”¯æŒ Iterator æ¥å£ï¼Œé…åˆå˜é‡çš„è§£æ„èµ‹å€¼ï¼Œè·å–é”®åå’Œé”®å€¼å°±éå¸¸æ–¹ä¾¿ã€‚
```js
const map = new Map();
map.set('first', 'hello');
map.set('second', 'world');
for (let [key, value] of map) {
  console.log(key + " is " + value);
}
// first is hello
// second is world
```
#### â‘¦è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³•
```js
const { SourceMapConsumer, SourceNode } = require("source-map");
```

## No4.å­—ç¬¦ä¸²çš„æ‰©å±•
### I.å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•
å…è®¸é‡‡ç”¨\uxxxxå½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­xxxxè¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹
```js
"\u0061"
// "a"

//è¿™ç§è¡¨ç¤ºæ³•åªé™äºç ç‚¹åœ¨\u0000~\uFFFFä¹‹é—´çš„å­—ç¬¦ã€‚
//è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨ç¤º
"\uD842\uDFB7"
// "ğ ®·"

"\u20BB7"
// " 7"
//å¦‚æœç›´æ¥åœ¨\uåé¢è·Ÿä¸Šè¶…è¿‡0xFFFFçš„æ•°å€¼ï¼ˆæ¯”å¦‚\u20BB7ï¼‰ï¼Œ
//JavaScript ä¼šç†è§£æˆ\u20BB+7ã€‚
//ç”±äº\u20BBæ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œ
//æ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª7
```
åªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦
```js
"\u{20BB7}"
// "ğ ®·"
```
javaScript å…±æœ‰ 6 ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚
```js
'\z' === 'z'  // true
'\172' === 'z' // true
'\x7A' === 'z' // true
'\u007A' === 'z' // true
'\u{7A}' === 'z' // true
```
### II.å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£
å­—ç¬¦ä¸²å¯ä»¥è¢«for...ofå¾ªç¯éå†,for ofå¯ä»¥è¯†åˆ«å¤§äº0xFFFFçš„ç ç‚¹ï¼Œä¼ ç»Ÿçš„forå¾ªç¯æ— æ³•è¯†åˆ«è¿™æ ·çš„ç ç‚¹ã€‚
```js
//å­—ç¬¦ä¸²textåªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œ
//ä½†æ˜¯forå¾ªç¯ä¼šè®¤ä¸ºå®ƒåŒ…å«ä¸¤ä¸ªå­—ç¬¦ï¼ˆéƒ½ä¸å¯æ‰“å°ï¼‰ï¼Œ
//è€Œfor...ofå¾ªç¯ä¼šæ­£ç¡®è¯†åˆ«å‡ºè¿™ä¸€ä¸ªå­—ç¬¦
let text = String.fromCodePoint(0x20BB7);
for (let i = 0; i < text.length; i++) {
  console.log(text[i]);
}
// " "
// " "
for (let i of text) {
  console.log(i);
}
// "ğ ®·"
```
### III.ç›´æ¥è¾“å…¥ U+2028 å’Œ U+2029
1. JavaScript è§„å®šæœ‰5ä¸ªå­—ç¬¦ï¼Œä¸èƒ½åœ¨å­—ç¬¦ä¸²é‡Œé¢ç›´æ¥ä½¿ç”¨ï¼Œåªèƒ½ä½¿ç”¨è½¬ä¹‰å½¢å¼
U+005Cï¼šåæ–œæ ï¼ˆreverse solidus)
U+000Dï¼šå›è½¦ï¼ˆcarriage returnï¼‰
U+2028ï¼šè¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰
U+2029ï¼šæ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰
U+000Aï¼šæ¢è¡Œç¬¦ï¼ˆline feedï¼‰
**ä¸¾ä¾‹æ¥è¯´ï¼Œå­—ç¬¦ä¸²é‡Œé¢ä¸èƒ½ç›´æ¥åŒ…å«åæ–œæ ï¼Œä¸€å®šè¦è½¬ä¹‰å†™æˆ\\æˆ–è€…\u005cã€‚**
2. JSON æ ¼å¼å…è®¸å­—ç¬¦ä¸²é‡Œé¢ç›´æ¥ä½¿ç”¨ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼ŒæœåŠ¡å™¨è¾“å‡ºçš„ JSON è¢«JSON.parseè§£æï¼Œå°±æœ‰å¯èƒ½ç›´æ¥æŠ¥é”™
```js
const json = '"\u2028"';
JSON.parse(json); // å¯èƒ½æŠ¥é”™
```
ä¸ºäº†æ¶ˆé™¤è¿™ä¸ªæŠ¥é”™ï¼ŒES2019 å…è®¸ JavaScript å­—ç¬¦ä¸²ç›´æ¥è¾“å…¥ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰ã€‚
```js
const PS = eval("'\u2029'");
```
3. æ¨¡æ¿å­—ç¬¦ä¸²ç°åœ¨å°±å…è®¸ç›´æ¥è¾“å…¥è¿™ä¸¤ä¸ªå­—ç¬¦ã€‚
å¦å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¾ç„¶ä¸å…è®¸ç›´æ¥è¾“å…¥è¿™ä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸º JSON æœ¬æ¥å°±ä¸å…è®¸ç›´æ¥åŒ…å«æ­£åˆ™è¡¨è¾¾å¼
### IV.JSON.stringify() çš„æ”¹é€ 
JSON æ•°æ®å¿…é¡»æ˜¯ UTF-8 ç¼–ç ã€‚
* \uD834\uDF06æ˜¯ä¸¤ä¸ªç ç‚¹ï¼Œå¿…é¡»æ”¾åœ¨ä¸€èµ·é…å¯¹ä½¿ç”¨ï¼Œä»£è¡¨å­—ç¬¦ğŒ†ã€‚è¿™æ˜¯ä¸ºäº†è¡¨ç¤ºç ç‚¹å¤§äº0xFFFFçš„å­—ç¬¦çš„ä¸€ç§å˜é€šæ–¹æ³•ã€‚å•ç‹¬ä½¿ç”¨\uD834å’Œ\uDFO6è¿™ä¸¤ä¸ªç ç‚¹æ˜¯ä¸åˆæ³•çš„ï¼Œæˆ–è€…é¢ å€’é¡ºåºä¹Ÿä¸è¡Œï¼Œå› ä¸º\uDF06\uD834å¹¶æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ã€‚

* JSON.stringify()çš„é—®é¢˜åœ¨äºï¼Œå®ƒ**å¯èƒ½è¿”å›0xD800åˆ°0xDFFFä¹‹é—´çš„å•ä¸ªç ç‚¹ï¼Œå³ä½¿å®ƒä¸å¯¹åº”ä»»ä½•å­—ç¬¦**
```js
JSON.stringify('\u{D834}') // "\u{D834}"(æ²¡æœ‰å¯¹åº”å­—ç¬¦)
```
å¦‚æœé‡åˆ°0xD800åˆ°0xDFFFä¹‹é—´çš„å•ä¸ªç ç‚¹ï¼Œæˆ–è€…ä¸å­˜åœ¨çš„é…å¯¹å½¢å¼ï¼Œ**ç°åœ¨ï¼JSON.stringify()ä¼šè¿”å›è½¬ä¹‰å­—ç¬¦ä¸²ï¼Œç•™ç»™åº”ç”¨è‡ªå·±å†³å®šä¸‹ä¸€æ­¥çš„å¤„ç†**ã€‚
```js
JSON.stringify('\u{D834}') // ""\\uD834""
JSON.stringify('\uDF06\uD834') // ""\\udf06\\ud834""
```
### V.æ¨¡æ¿å­—ç¬¦ä¸²
æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨**åå¼•å·ï¼ˆ\`ï¼‰** æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚
```JS
// æ™®é€šå­—ç¬¦ä¸²
`In JavaScript '\n' is a line-feed.`
// å¤šè¡Œå­—ç¬¦ä¸²
console.log(`string text line 1
string text line 2`);
// å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡
let name = "Bob", time = "today";
`Hello ${name}, how are you ${time}?`
```
åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­éœ€è¦ä½¿ç”¨åå¼•å·ï¼Œåˆ™å‰é¢è¦ç”¨åæ–œæ è½¬ä¹‰.
```JS
å®ç°è®¡ç®—
let x = 1;
let y = 2;
`${x} + ${y} = ${x + y}`
// "1 + 2 = 3"
let obj = {x: 1, y: 2};
`${obj.x + obj.y}`
// "3"
è¿˜èƒ½è°ƒç”¨å‡½æ•°
function fn() {
  return "Hello World";
}
`foo ${fn()} bar`
// foo Hello World bar
æˆä¸ºå‡½æ•°çš„è¿”å›å€¼
let func = (name) => `Hello ${name}!`;
func('Jack') // "Hello Jack!"
```
### VI.ä½¿ç”¨æ¨¡æ¿ç¼–è¯‘çš„ä¸€ä¸ªå®ä¾‹ï¼ˆå·²ä¿å­˜åœ¨BYå‰ç«¯æ–‡ä»¶å¤¹ï¼‰
https://www.bookstack.cn/read/es6-3rd/spilt.6.docs-string.md
### VII.æ ‡ç­¾æ¨¡æ¿
#### â‘ å®šä¹‰
æ¨¡æ¿å­—ç¬¦ä¸²å¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸ºâ€œæ ‡ç­¾æ¨¡æ¿â€åŠŸèƒ½ï¼ˆtagged templateï¼‰
```JS
alert`hello`
// ç­‰åŒäº
alert(['hello'])
```
#### â‘¡ç”¨æ³•
"æ ‡ç­¾"æŒ‡çš„å°±æ˜¯å‡½æ•°ï¼Œç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²å°±æ˜¯å®ƒçš„å‚æ•°
* å¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯**ä¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•°**
```JS
let a = 5;
let b = 10;
tag`Hello ${ a + b } world ${ a * b }`;
// ç­‰åŒäº
tag(['Hello ', ' world ', ''], 15, 50);
```
>tagæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚æ•´ä¸ªè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå°±æ˜¯tagå‡½æ•°å¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²åçš„è¿”å›å€¼ã€‚
tagå‡½æ•°çš„**ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„**ï¼Œè¯¥æ•°ç»„çš„æˆå‘˜æ˜¯**æ¨¡æ¿å­—ç¬¦ä¸²ä¸­é‚£äº›æ²¡æœ‰å˜é‡æ›¿æ¢çš„éƒ¨åˆ†**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå˜é‡æ›¿æ¢åªå‘ç”Ÿåœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ä¸ç¬¬äºŒä¸ªæˆå‘˜**ä¹‹é—´**ã€ç¬¬äºŒä¸ªæˆå‘˜ä¸ç¬¬ä¸‰ä¸ªæˆå‘˜**ä¹‹é—´**ï¼Œä»¥æ­¤ç±»æ¨ã€‚
tagå‡½æ•°çš„å…¶ä»–å‚æ•°ï¼Œéƒ½æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²å„ä¸ªå˜é‡è¢«æ›¿æ¢åçš„å€¼ã€‚
ä¸‹é¢å°†å„å‚æ•°èƒ½å¤Ÿæ··åˆä½¿ç”¨
```js
let total = 30;
let msg = passthru`The total is ${total} (${total*1.05} with tax)`;
function passthru(literals) {
  let result = '';
  let i = 0;
  while (i < literals.length) {
    result += literals[i++];
    if (i < arguments.length) {
      result += arguments[i];
    }
  }
  return result;
}
msg // "The total is 30 (31.5 with tax)"
```
#### â‘¢å®é™…åº”ç”¨
1. è¿‡æ»¤ HTML å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ã€‚
```js
let message =
  SaferHTML`<p>${sender} has sent you a message.</p>`;
function SaferHTML(templateData) {
  let s = templateData[0];
  for (let i = 1; i < arguments.length; i++) {
    let arg = String(arguments[i]);
    // Escape special characters in the substitution.
    s += arg.replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;");
    // Don't escape special characters in the template.
    s += templateData[i];
  }
  return s;
}
```
ä¸Šé¢ä»£ç ä¸­ï¼Œsenderå˜é‡å¾€å¾€æ˜¯ç”¨æˆ·æä¾›çš„ï¼Œç»è¿‡SaferHTMLå‡½æ•°å¤„ç†ï¼Œé‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦éƒ½ä¼šè¢«è½¬ä¹‰ã€‚
```js
let sender = '<script>alert("abc")</script>'; // æ¶æ„ä»£ç 
let message = SaferHTML`<p>${sender} has sent you a message.</p>`;
message
// <p>&lt;script&gt;alert("abc")&lt;/script&gt; has sent you a message.</p>
```
2. å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚
```js
i18n`Welcome to ${siteName}, you are visitor number ${visitorNumber}!`
// "æ¬¢è¿è®¿é—®xxxï¼Œæ‚¨æ˜¯ç¬¬xxxxä½è®¿é—®è€…ï¼"
```
3. ç”šè‡³å¯ä»¥ä½¿ç”¨æ ‡ç­¾æ¨¡æ¿ï¼Œåœ¨ JavaScript è¯­è¨€ä¹‹ä¸­åµŒå…¥å…¶ä»–è¯­è¨€ã€‚
4. æ¨¡æ¿å¤„ç†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²æ•°ç»„ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªrawå±æ€§ã€‚
```js
tag`First line\nSecond line`
function tag(strings) {
  console.log(strings.raw[0]);
  // strings.raw[0] ä¸º "First line\\nSecond line"
  // æ‰“å°è¾“å‡º "First line\nSecond line"
}
```
>stringsæ•°ç»„æ˜¯["First line\nSecond line"]ï¼Œ
strings.rawæ•°ç»„å°±æ˜¯["First line\\\nSecond line"]ã€‚
ä¸¤è€…å”¯ä¸€çš„åŒºåˆ«ï¼Œå°±æ˜¯å­—ç¬¦ä¸²é‡Œé¢çš„æ–œæ éƒ½è¢«è½¬ä¹‰äº†ã€‚æ¯”å¦‚ï¼Œstrings.raw æ•°ç»„ä¼šå°†\nè§†ä¸º\\\å’Œnä¸¤ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯æ¢è¡Œç¬¦ã€‚è¿™æ˜¯ä¸ºäº†æ–¹ä¾¿å–å¾—è½¬ä¹‰ä¹‹å‰çš„åŸå§‹æ¨¡æ¿è€Œè®¾è®¡çš„
#### â‘£æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶(ä¼šé»˜è®¤è½¬ä¹‰)
æ ‡ç­¾æ¨¡æ¿é‡Œé¢ï¼Œå¯ä»¥å†…åµŒå…¶ä»–è¯­è¨€ã€‚ä½†æ˜¯ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²**é»˜è®¤ä¼šå°†å­—ç¬¦ä¸²è½¬ä¹‰**ï¼Œå¯¼è‡´æ— æ³•åµŒå…¥å…¶ä»–è¯­è¨€.
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES2018 æ”¾æ¾äº†å¯¹æ ‡ç­¾æ¨¡æ¿é‡Œé¢çš„å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ã€‚å¦‚æœé‡åˆ°ä¸åˆæ³•çš„å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå°±è¿”å›undefinedï¼Œè€Œä¸æ˜¯æŠ¥é”™ï¼Œå¹¶ä¸”ä»rawå±æ€§ä¸Šé¢å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²
```js
function tag(strs) {
  strs[0] === undefined
  strs.raw[0] === "\\unicode and \\u{55}";
}
tag`\unicode and \u{55}`
```
>å¯¹å­—ç¬¦ä¸²è½¬ä¹‰çš„æ”¾æ¾ï¼Œåªåœ¨æ ‡ç­¾æ¨¡æ¿è§£æå­—ç¬¦ä¸²æ—¶ç”Ÿæ•ˆï¼Œä¸æ˜¯æ ‡ç­¾æ¨¡æ¿çš„åœºåˆï¼Œä¾ç„¶ä¼šæŠ¥é”™ã€‚
`let bad = `bad escape sequence: \unicode`; // æŠ¥é”™`
## No5.å­—ç¬¦ä¸²çš„æ–°å¢æ–¹æ³•(å¤ä¹ é«˜ç¨‹)
